This code used a lot skills of a CSDN user named *Fun'*